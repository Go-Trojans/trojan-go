"""
Author : 
File   : alphaZero_nn.py
Date   : 11th July 2020

Description : Have the same deep neural network as AlphaGoZero
"""


"""
s{t} = [X{t}, Y{t}, X{t−1}, Y{t−1},..., X{t−7}, Y{t−7}, C].
The input features s{t} are processed by a residual tower that consists of a single convolutional block 
followed by either 19 or 39 residual blocks.

The convolutional block applies the following modules:
(1) A convolution of 256 filters of kernel size 3 × 3 with stride 1
(2) Batch normalization
(3) A rectifier nonlinearity

Each residual block applies the following modules sequentially to its input: 
(1) A convolution of 256 filters of kernel size 3 × 3 with stride 1
(2) Batch normalization
(3) A rectifier nonlinearity
(4) A convolution of 256 filters of kernel size 3 × 3 with stride 1
(5) Batch normalization
(6) A skip connection that adds the input to the block
(7) A rectifier nonlinearity

The output of the residual tower is passed into two separate ‘heads’ for computing the policy and value. 

The policy head applies the following modules: 
(1) A convolution of 2 filters of kernel size 1 × 1 with stride 1
(2) Batch normalization
(3) A rectifier nonlinearity
(4) A fully connected linear layer that outputs a vector of size 19*19 + 1 = 362, corresponding to logit probabilities for all intersections and the pass move

The value head applies the following modules:
(1) A convolution of 1 filter of kernel size 1 × 1 with stride 1 
(2) Batch normalization
(3) A rectifier nonlinearity
(4) A fully connected linear layer to a hidden layer of size 256
(5) A rectifier nonlinearity
(6) A fully connected linear layer to a scalar
(7) A tanh nonlinearity outputting a scalar in the range [−1, 1]

The overall network depth, in the 20­ or 40­ block network, is 39 or 79 parameterized layers, respectively, 
for the residual tower, plus an additional 2 layers for the policy head and 3 layers for the value head.
"""
import keras
from keras.layers import Activation, BatchNormalization
from keras.layers import Conv2D, Dense, Flatten, Input
from keras.models import Model


class trojanGoZero:
    def __init__(self, num_resnet_block=19):
        #self.board_input = Input(shape=TrojanGoPlane.shape(), name='board_input')
        self.board_input = Input(shape=(7, 5, 5), name='board_input')
        self.num_resnet_block = num_resnet_block
        self.num_filters = 256

    
    def resNetBlock(self, x,filters,pool=False):
        res = x
        
        if pool:
            x = MaxPooling2D(pool_size=(2, 2))(x)
            res = Conv2D(filters=filters,kernel_size=[1,1],strides=(2,2),padding="same")(res)
        #out = BatchNormalization()(x)
        #out = Activation("relu")(out)
            
        out = Conv2D(filters=filters, kernel_size=[3, 3], strides=[1, 1], padding="same")(x)
        out = BatchNormalization()(out) # model.add(BatchNormalization(axis=1))
        out = Activation("relu")(out)
        
        out = Conv2D(filters=filters, kernel_size=[3, 3], strides=[1, 1], padding="same")(out)
        out = BatchNormalization()(out)
        
        out = keras.layers.add([res,out])
        out = Activation("relu")(out)

        return out


        
    def nn_model(self):
        #Input feature of 17*19*19 or 7*5*5 as board_input or board_images
        
        #board_images = Input(self.board_input)
        board_images = self.board_input

        #CNN-1 with Batch Normalization and rectifier nonlinearity.
        cnn1 = Conv2D(filters=256, kernel_size=[3, 3], strides=[1, 1], padding="same")(board_images)
        cnn1_batch = BatchNormalization()(cnn1) 
        cnn1_act = Activation("relu")(cnn1_batch)

        self_in = cnn1_act
        
        #Now build 19 or 39 ResNet block networks depends on "num_resnet_block" variable.
        for i in range(self.num_resnet_block):
            self_out = self.resNetBlock(self_in, self.num_filters)
            self_in = self_out

        out = self_out
        
        policy_conv = \
            Conv2D(2, (1, 1),                          # <2>
                data_format='channels_first',          # <2>
                activation='relu')(out)                # <2>
        policy_flat = Flatten()(policy_conv)           # <2>
        policy_output = \
            Dense(26,
                  activation='softmax')(policy_flat)   # <2>




        value_conv = \
            Conv2D(1, (1, 1),                                    # <3>
                data_format='channels_first',                    # <3>
                activation='relu')(out)                          # <3>
        value_flat = Flatten()(value_conv)                       # <3>
        value_hidden = Dense(256, activation='relu')(value_flat) # <3>
        value_output = Dense(1, activation='tanh')(value_hidden) # <3>

        model = Model(
            inputs=[self.board_input],
            outputs=[policy_output, value_output])

        return model



"""
Driver code
"""
if __name__ == "__main__":
    net = trojanGoZero()
    model = net.nn_model()
    print(model.summary())


"""= RESTART: /Users/pujakumari/Desktop/TROJANGO/trojan-go/code/algos/nn/alphaZero_nn.py
Using TensorFlow backend.
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
board_input (InputLayer)        (None, 7, 5, 5)      0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 7, 5, 256)    11776       board_input[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 7, 5, 256)    1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 7, 5, 256)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 7, 5, 256)    590080      activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 7, 5, 256)    1024        conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 7, 5, 256)    0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 7, 5, 256)    590080      activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 7, 5, 256)    1024        conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 7, 5, 256)    0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 7, 5, 256)    0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 5, 256)    590080      activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 5, 256)    1024        conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 7, 5, 256)    0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 5, 256)    590080      activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 7, 5, 256)    1024        conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 7, 5, 256)    0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 7, 5, 256)    0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 7, 5, 256)    590080      activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 7, 5, 256)    1024        conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 7, 5, 256)    0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 7, 5, 256)    590080      activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 7, 5, 256)    1024        conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 7, 5, 256)    0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 7, 5, 256)    0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 7, 5, 256)    590080      activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 7, 5, 256)    1024        conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 7, 5, 256)    0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 7, 5, 256)    590080      activation_8[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 7, 5, 256)    1024        conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 7, 5, 256)    0           activation_7[0][0]               
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 7, 5, 256)    0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 7, 5, 256)    590080      activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 7, 5, 256)    1024        conv2d_10[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 7, 5, 256)    0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 7, 5, 256)    590080      activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 7, 5, 256)    1024        conv2d_11[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 7, 5, 256)    0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 7, 5, 256)    0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 7, 5, 256)    590080      activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 7, 5, 256)    1024        conv2d_12[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 7, 5, 256)    0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 7, 5, 256)    590080      activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 7, 5, 256)    1024        conv2d_13[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 7, 5, 256)    0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 7, 5, 256)    0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 7, 5, 256)    590080      activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 7, 5, 256)    1024        conv2d_14[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 7, 5, 256)    0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 7, 5, 256)    590080      activation_14[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 7, 5, 256)    1024        conv2d_15[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 7, 5, 256)    0           activation_13[0][0]              
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 7, 5, 256)    0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 7, 5, 256)    590080      activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 7, 5, 256)    1024        conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 7, 5, 256)    0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 7, 5, 256)    590080      activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 7, 5, 256)    1024        conv2d_17[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 7, 5, 256)    0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 7, 5, 256)    0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 7, 5, 256)    590080      activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 7, 5, 256)    1024        conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 7, 5, 256)    0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 7, 5, 256)    590080      activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 7, 5, 256)    1024        conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 7, 5, 256)    0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 7, 5, 256)    0           add_9[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 7, 5, 256)    590080      activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 7, 5, 256)    1024        conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 7, 5, 256)    0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 7, 5, 256)    590080      activation_20[0][0]              
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 7, 5, 256)    1024        conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_10 (Add)                    (None, 7, 5, 256)    0           activation_19[0][0]              
                                                                 batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 7, 5, 256)    0           add_10[0][0]                     
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 7, 5, 256)    590080      activation_21[0][0]              
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 7, 5, 256)    1024        conv2d_22[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 7, 5, 256)    0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 7, 5, 256)    590080      activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 7, 5, 256)    1024        conv2d_23[0][0]                  
__________________________________________________________________________________________________
add_11 (Add)                    (None, 7, 5, 256)    0           activation_21[0][0]              
                                                                 batch_normalization_23[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 7, 5, 256)    0           add_11[0][0]                     
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 7, 5, 256)    590080      activation_23[0][0]              
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 7, 5, 256)    1024        conv2d_24[0][0]                  
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 7, 5, 256)    0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 7, 5, 256)    590080      activation_24[0][0]              
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 7, 5, 256)    1024        conv2d_25[0][0]                  
__________________________________________________________________________________________________
add_12 (Add)                    (None, 7, 5, 256)    0           activation_23[0][0]              
                                                                 batch_normalization_25[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 7, 5, 256)    0           add_12[0][0]                     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 7, 5, 256)    590080      activation_25[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 7, 5, 256)    1024        conv2d_26[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 7, 5, 256)    0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 7, 5, 256)    590080      activation_26[0][0]              
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 7, 5, 256)    1024        conv2d_27[0][0]                  
__________________________________________________________________________________________________
add_13 (Add)                    (None, 7, 5, 256)    0           activation_25[0][0]              
                                                                 batch_normalization_27[0][0]     
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 7, 5, 256)    0           add_13[0][0]                     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 7, 5, 256)    590080      activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 7, 5, 256)    1024        conv2d_28[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 7, 5, 256)    0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 7, 5, 256)    590080      activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 7, 5, 256)    1024        conv2d_29[0][0]                  
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 5, 256)    0           activation_27[0][0]              
                                                                 batch_normalization_29[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 7, 5, 256)    0           add_14[0][0]                     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 7, 5, 256)    590080      activation_29[0][0]              
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 7, 5, 256)    1024        conv2d_30[0][0]                  
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 7, 5, 256)    0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 7, 5, 256)    590080      activation_30[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 7, 5, 256)    1024        conv2d_31[0][0]                  
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 5, 256)    0           activation_29[0][0]              
                                                                 batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 7, 5, 256)    0           add_15[0][0]                     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 7, 5, 256)    590080      activation_31[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 7, 5, 256)    1024        conv2d_32[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 7, 5, 256)    0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 7, 5, 256)    590080      activation_32[0][0]              
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 7, 5, 256)    1024        conv2d_33[0][0]                  
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 5, 256)    0           activation_31[0][0]              
                                                                 batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 7, 5, 256)    0           add_16[0][0]                     
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 7, 5, 256)    590080      activation_33[0][0]              
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 7, 5, 256)    1024        conv2d_34[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 7, 5, 256)    0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 7, 5, 256)    590080      activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 7, 5, 256)    1024        conv2d_35[0][0]                  
__________________________________________________________________________________________________
add_17 (Add)                    (None, 7, 5, 256)    0           activation_33[0][0]              
                                                                 batch_normalization_35[0][0]     
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 7, 5, 256)    0           add_17[0][0]                     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 7, 5, 256)    590080      activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 7, 5, 256)    1024        conv2d_36[0][0]                  
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 7, 5, 256)    0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 7, 5, 256)    590080      activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 7, 5, 256)    1024        conv2d_37[0][0]                  
__________________________________________________________________________________________________
add_18 (Add)                    (None, 7, 5, 256)    0           activation_35[0][0]              
                                                                 batch_normalization_37[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 7, 5, 256)    0           add_18[0][0]                     
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 7, 5, 256)    590080      activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 7, 5, 256)    1024        conv2d_38[0][0]                  
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 7, 5, 256)    0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 7, 5, 256)    590080      activation_38[0][0]              
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 7, 5, 256)    1024        conv2d_39[0][0]                  
__________________________________________________________________________________________________
add_19 (Add)                    (None, 7, 5, 256)    0           activation_37[0][0]              
                                                                 batch_normalization_39[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 7, 5, 256)    0           add_19[0][0]                     
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 1, 5, 256)    8           activation_39[0][0]              
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 2, 5, 256)    16          activation_39[0][0]              
__________________________________________________________________________________________________
flatten_2 (Flatten)             (None, 1280)         0           conv2d_41[0][0]                  
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2560)         0           conv2d_40[0][0]                  
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 256)          327936      flatten_2[0][0]                  
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 26)           66586       flatten_1[0][0]                  
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 1)            257         dense_2[0][0]                    
==================================================================================================
Total params: 22,869,555
Trainable params: 22,849,587
Non-trainable params: 19,968
__________________________________________________________________________________________________
None
>>>
"""
